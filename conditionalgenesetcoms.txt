##### MAGMA conditional gene-set analysis ##########################


#With APOE
#magma.genes.raw generated by FUMA. MHC region excluded


#magma_GS.txt is a file with all of the gene-sets in FUMA
#list.txt is a file with the names of the significant genesets
#list.txt
GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process
Curated_gene_sets:roversi_glioma_copy_number_up
GO_cc:go_neurofibrillary_tangle
GO_bp:go_regulation_of_amyloid_beta_formation
GO_bp:go_regulation_of_aspartic_type_endopeptidase_activity_involved_in_amyloid_precursor_protein_catabolic_process
GO_bp:go_regulation_of_amyloid_precursor_protein_catabolic_process
GO_bp:go_regulation_of_aspartic_type_peptidase_activity
GO_bp:go_amyloid_beta_formation
GO_bp:go_amyloid_beta_metabolic_process
GO_bp:go_negative_regulation_of_metalloendopeptidase_activity
GO_bp:go_amyloid_precursor_protein_catabolic_process
GO_bp:go_negative_regulation_of_metallopeptidase_activity
Curated_gene_sets:reactome_immunoregulatory_interactions_between_a_lymphoid_and_a_non_lymphoid_cell
GO_bp:go_regulation_of_metalloendopeptidase_activity
GO_bp:go_regulation_of_tau_protein_kinase_activity
GO_mf:go_tau_protein_binding
GO_bp:go_amyloid_precursor_protein_metabolic_process
GO_bp:go_reverse_cholesterol_transport
GO_bp:go_regulation_of_metallopeptidase_activity
GO_bp:go_amyloid_beta_clearance
GO_bp:go_positive_regulation_of_amyloid_beta_formation
GO_bp:go_immune_response_inhibiting_signal_transduction
GO_bp:go_positive_regulation_of_amyloid_precursor_protein_catabolic_process
GO_bp:go_phospholipid_efflux
GO_cc:go_protein_lipid_complex

#### lets do forward selection
#1 condition on the most significant geneset
./magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co1 --model analyse=file,list.txt condition= GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process

#2 select the next most significant gene-set and previous ones
./magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co2 --model analyse=file,list.txt condition=GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process,Curated_gene_sets:roversi_glioma_copy_number_up


#3 Repeat until no gene-set is significant P<3.228931e-06
./magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co3 --model analyse=file,list.txt condition=GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process,Curated_gene_sets:roversi_glioma_copy_number_up,GO_cc:go_neurofibrillary_tangle


#4
./magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co4 --model analyse=file,list.txt condition=GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process,Curated_gene_sets:roversi_glioma_copy_number_up,GO_cc:go_neurofibrillary_tangle,Curated_gene_sets:reactome_immunoregulatory_interactions_between_a_lymphoid_and_a_non_lymphoid_cell
 




Without APOE
#magma.genes.raw generated by FUMA. APOE and MHC region excluded

#magma_GS.txt is a file with all of the gene-sets in FUMA
#list.txt is a file with the names of the significant genesets
#list.txt
GO_cc:go_neurofibrillary_tangle
GO_bp:go_negative_regulation_of_amyloid_precursor_protein_catabolic_process
GO_bp:go_regulation_of_aspartic_type_endopeptidase_activity_involved_in_amyloid_precursor_protein_catabolic_process
GO_bp:go_regulation_of_aspartic_type_peptidase_activity
GO_bp:go_regulation_of_amyloid_beta_formation
GO_bp:go_regulation_of_amyloid_precursor_protein_catabolic_process
GO_bp:go_negative_regulation_of_metalloendopeptidase_activity
GO_bp:go_amyloid_beta_metabolic_process
GO_bp:go_regulation_of_tau_protein_kinase_activity
GO_bp:go_amyloid_beta_formation
GO_bp:go_negative_regulation_of_metallopeptidase_activity
GO_bp:go_regulation_of_metalloendopeptidase_activity
GO_bp:go_amyloid_precursor_protein_catabolic_process
Curated_gene_sets:reactome_immunoregulatory_interactions_between_a_lymphoid_and_a_non_lymphoid_cell
GO_bp:go_positive_regulation_of_amyloid_beta_formation
GO_bp:go_regulation_of_metallopeptidase_activity
GO_bp:go_immune_response_inhibiting_signal_transduction
GO_bp:go_positive_regulation_of_amyloid_precursor_protein_catabolic_process
GO_bp:go_regulation_of_astrocyte_activation
GO_bp:go_amyloid_precursor_protein_metabolic_process
GO_bp:go_positive_regulation_of_tau_protein_kinase_activity

#### condition on the most significant geneset
#1
magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co1 --model analyse=file,list.txt condition=GO_cc:go_neurofibrillary_tangle


#2 select the next most significant gene-set and previous ones
magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co2 --model analyse=file,list.txt condition=GO_cc:go_neurofibrillary_tangle,GO_bp:go_regulation_of_aspartic_type_endopeptidase_activity_involved_in_amyloid_precursor_protein_catabolic_process

#3 Repeat until no gene-set is significant P<3.226639e-06
magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co3 --model analyse=file,list.txt condition=GO_cc:go_neurofibrillary_tangle,GO_bp:go_regulation_of_aspartic_type_endopeptidase_activity_involved_in_amyloid_precursor_protein_catabolic_process,Curated_gene_sets:reactome_immunoregulatory_interactions_between_a_lymphoid_and_a_non_lymphoid_cell

#4
magma --gene-results magma.genes.raw --set-annot magma_GS.txt --out co4 --model analyse=file,list.txt condition=GO_cc:go_neurofibrillary_tangle,GO_bp:go_regulation_of_aspartic_type_endopeptidase_activity_involved_in_amyloid_precursor_protein_catabolic_process,Curated_gene_sets:reactome_immunoregulatory_interactions_between_a_lymphoid_and_a_non_lymphoid_cell,GO_bp:go_regulation_of_astrocyte_activation


